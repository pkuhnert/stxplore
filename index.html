<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.">
<title>Exploration of Spatio-Temporal Data • stxplore</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Exploration of Spatio-Temporal Data">
<meta property="og:description" content="More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">stxplore</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/stxplore.html">Exploration using dataframes</a>
    <a class="dropdown-item" href="articles/stxplore_stars.html">Exploration using stars objects</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="stxplore">stxplore<a class="anchor" aria-label="anchor" href="#stxplore"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of stxplore is to explore spatio-temporal data. It can take in either dataframes or stars objects. It is a tool for exploratory data analysis.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of stxplore from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"sevvandi/stxplore"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-quick-introduction">A quick introduction<a class="anchor" aria-label="anchor" href="#a-quick-introduction"></a>
</h2>
<p>Let’s first explore some spatio-temporal data using dataframes. The dataset NOAA_df_1990 has temperature and precipitation for from 1990 to 1993 for selected locations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sevvandi.github.io/stxplore/">stxplore</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NOAA_df_1990"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">precip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">NOAA_df_1990</span>,</span>
<span>  <span class="va">proc</span> <span class="op">==</span> <span class="st">"Precip"</span> <span class="op">&amp;</span></span>
<span>  <span class="va">year</span> <span class="op">==</span> <span class="fl">1993</span><span class="op">)</span></span>
<span><span class="va">precip</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="va">precip</span><span class="op">$</span><span class="va">julian</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">precip</span><span class="op">$</span><span class="va">julian</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">precip</span><span class="op">)</span></span>
<span><span class="co">#&gt;   julian year month day   id    z   proc   lat       lon       date t</span></span>
<span><span class="co">#&gt; 1 727930 1993     1   1 3804 0.00 Precip 39.35 -81.43333 1993-01-01 1</span></span>
<span><span class="co">#&gt; 2 727931 1993     1   2 3804 0.00 Precip 39.35 -81.43333 1993-01-02 2</span></span>
<span><span class="co">#&gt; 3 727932 1993     1   3 3804 0.03 Precip 39.35 -81.43333 1993-01-03 3</span></span>
<span><span class="co">#&gt; 4 727933 1993     1   4 3804 0.37 Precip 39.35 -81.43333 1993-01-04 4</span></span>
<span><span class="co">#&gt; 5 727934 1993     1   5 3804 0.09 Precip 39.35 -81.43333 1993-01-05 5</span></span>
<span><span class="co">#&gt; 6 727935 1993     1   6 3804 0.00 Precip 39.35 -81.43333 1993-01-06 6</span></span></code></pre></div>
<p>The z variable has precipitation in this in dataset. Let’s visualize the mean precipitation over time.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tem</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/temporal_means.html">temporal_means</a></span><span class="op">(</span><span class="va">precip</span>,</span>
<span>                      t_col <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>                      z_col <span class="op">=</span> <span class="st">'z'</span>,</span>
<span>                      id_col <span class="op">=</span> <span class="st">'id'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">tem</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Mean Precipitation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-tempmeans-1.png" width="100%"> Let’s look at minimum temperature. Let’s first subset the dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">NOAA_df_1990</span>,</span>
<span>  <span class="va">proc</span> <span class="op">==</span> <span class="st">"Tmin"</span> <span class="op">&amp;</span></span>
<span>  <span class="va">year</span> <span class="op">==</span> <span class="fl">1993</span><span class="op">)</span></span></code></pre></div>
<p>Ridgeline plots break up the quantity of interest into several groups and shows its distribution. We use the R package <em>ggridges</em> (Wilke 2021) underneath. In this Ridgeline plot we see how the minimum temperature for higher latitudes is lower.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ridgeline.html">ridgeline</a></span><span class="op">(</span><span class="va">tmin</span>, group_col <span class="op">=</span> <span class="st">'lat'</span>, z_col <span class="op">=</span> <span class="st">'z'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `stat(x)` was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `after_stat(x)` instead.</span></span>
<span><span class="co">#&gt; ℹ The deprecated feature was likely used in the stxplore package.</span></span>
<span><span class="co">#&gt;   Please report the issue to the authors.</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 3.27</span></span></code></pre></div>
<p><img src="reference/figures/README-ridgeline1-1.png" width="100%"></p>
<p>Of course if we group by longitude, there wouldn’t be much difference between the groups. What about the difference over time? Can we see that using Ridgeline plots?</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ridgeline.html">ridgeline</a></span><span class="op">(</span><span class="va">tmin</span>, group_col <span class="op">=</span> <span class="st">'date'</span>, z_col <span class="op">=</span> <span class="st">'z'</span>, num_grps <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.99</span></span></code></pre></div>
<p><img src="reference/figures/README-ridgeline3-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="moving-on-to-stars-objects">Moving on to stars objects<a class="anchor" aria-label="anchor" href="#moving-on-to-stars-objects"></a>
</h2>
<p>The stars dataset aerosol_australia has aerosol optical thickness over Australia and surrounds for 13 months starting from 2019 December to 2020 December. There were devastating bushfires in Australia during this time. The data was taken from NASA Earth Observations (NEO) website <a href="https://neo.gsfc.nasa.gov" class="external-link uri">https://neo.gsfc.nasa.gov</a> (“NASA Earth Observations (NEO),” n.d.).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"aerosol_australia"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">aerosol_australia</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                    Min. 1st Qu. Median     Mean 3rd Qu. Max.  NA's</span></span>
<span><span class="co">#&gt; aerosol_thickness     1      19     26 27.06014      33  254 13585</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from to offset delta refsys point                    values x/y</span></span>
<span><span class="co">#&gt; x       1 70    110     1 WGS 84 FALSE                      NULL [x]</span></span>
<span><span class="co">#&gt; y       1 70      0    -1 WGS 84 FALSE                      NULL [y]</span></span>
<span><span class="co">#&gt; date    1 13     NA    NA   Date    NA 2019-12-01,...,2020-12-01</span></span>
<span></span>
<span><span class="va">temp_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/temporal_means.html">temporal_means</a></span><span class="op">(</span><span class="va">aerosol_australia</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">temp_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 6513 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="reference/figures/README-stars1-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/ridgeline.html">ridgeline</a></span><span class="op">(</span><span class="va">aerosol_australia</span>, group_dim <span class="op">=</span> <span class="fl">3</span>, num_grps <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.72</span></span></code></pre></div>
<p><img src="reference/figures/README-stars1-2.png" width="100%"></p>
<p>We can see that during December and January there aerosols were much higher compared to other months.</p>
</div>
<div class="section level2">
<h2 id="the-making-of-stxplore">The making of stxplore<a class="anchor" aria-label="anchor" href="#the-making-of-stxplore"></a>
</h2>
<p>In 2017, Chris Wikle and Petra Kunhert taught a short course titled <em>An Introduction to Statistics for Spatio-Temporal Data</em>. The course was based on two books:</p>
<ol style="list-style-type: decimal">
<li>Statistics for Spatio-Temporal Data by Noel Cressie and Christopher K. Wikle (Cressie and Wikle 2015)</li>
<li>Spatio-Temporal Statistics with R by Christopher K. Wikle, Andrew Zammit-Mangion and Noel Cressie (Wikle, Zammit-Mangion, and Cressie
<ol start="2019" style="list-style-type: decimal"><li>
</li></ol>
</li>
</ol>
<p>There had been some discussions in making a separate package for spatio-temporal exploration. Even though there are many packages for spatio-temporal modelling, exploration is rarely given the spotlight. Many years later, Petra mentioned this to me and I’ve been involved in making it a reality.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-cressie2015statistics" class="csl-entry">
Cressie, Noel, and Christopher K Wikle. 2015. <em><span class="nocase">Statistics for spatio-temporal data</span></em>. John Wiley &amp; Sons.
</div>
<div id="ref-nasa" class="csl-entry">
“NASA Earth Observations (NEO).” n.d. NASA. <a href="https://neo.gsfc.nasa.gov/" class="external-link uri">https://neo.gsfc.nasa.gov/</a>.
</div>
<div id="ref-wikle2019spatio" class="csl-entry">
Wikle, Christopher K, Andrew Zammit-Mangion, and Noel Cressie. 2019. <em><span class="nocase">Spatio-temporal Statistics with R</span></em>. Chapman; Hall/CRC.
</div>
<div id="ref-ridgeline" class="csl-entry">
Wilke, Claus O. 2021. <em><span class="nocase">ggridges: Ridgeline Plots in ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggridges" class="external-link uri">https://CRAN.R-project.org/package=ggridges</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing stxplore</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sevvandi Kandanaarachchi <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0337-0395" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Petra Kunhert <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9070-0091" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/sevvandi/stxplore/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/sevvandi/stxplore/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sevvandi Kandanaarachchi, Petra Kunhert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
